@ /video root:video {
  #%pxr.format 2
  .renderer OpenGL
  @ ./output-1 video:output {
    #%graph.x 856
    #%graph.y 162
    .always-on-top true
  }
  @ ./custom-1 video:custom {
    #%graph.x 175
    #%graph.y 212
    .code "

    @P(1)
    float\[\] fft;

    @Override
    public void setup() \{
    \}

    @Override
    public void draw() \{

        stroke(255);
        if (fft.length > 0) \{
            for (int i = 0; i < width; i++) \{
                int idx = i * fft.length / width;
                float f = dB(fft\[idx\]);
//                offset = height - 1 - min(offset * height / 32, height - 1);
//                stroke(255 - ((double) i / width) * 255);
                line(i, height, i, height - (f*8));
            \}
        \}
    \}

    float dB(float x) \{
        if (x == 0) \{
            return 0;
        \} else \{
            return 10 * (float) Math.log10(x);
        \}
    \}
"
    .fft "rO0ABXVyAAJbRgucgYki4AxCAgAAeHAAAAIAPn5XMzvJmQo8KRd3PM3JJDuxFz08AwKSON9tmTnB
z3g6HuTiOcW7oTqQRZI6uJCWOigyszvmh6c7SBRuOuGv6DsBXjI6MfiTOz2Uxju60yw7lljUO5io
1z0HChE9Lv+uP56O+TzlsSc8JqgmO6offjuhzL47GXIgOw3CJjsEa2w7OwhrOkfK5ToFAqk7gOno
OzN3jDtCvXI7SEf8Owg9mDsdMXE5eOxKO5thBDulj1I8tTppPOsFdj0+N8k+z06IPyxBsT1kz+48
8RrGPIQv4jvAcEk8AHEjO4LhwjszL8o6n78DO62RHTur/bg7IPgQOsqFXjuuzDY7i/2QO8IHqTqI
I3g7j2TKOrYJWTtFEBI7qkwdOptaxjsPIcY7fLMeO5lYrTrzl5g7kQ2UO1+yzzuOcYM73r2rO7Wl
Fju5vO872MYvO+16GDvLYKQ716P6PBsCTjxKBiI8kgglPKcJ/zy/zXo9IxjuPWs2tj31vK8+oukc
QAGwyUDHqwQ+y4UePhKZTD2Sdec9I4QBPN6mdjyLLxQ8efz0PC+ffjwRhvQ78jZeO6+aFTuu4yg7
dA64O22bzztP1J07LtMcOxSvgDsH9Gg6/PKxOvUz3jrLVBM6za9GOpudmDpGMoY65DFqOkP2Vjpe
Hxw5a6P0Ox6WPztzryc9IqsmO7maLDqRcyQ6nQN/OmeGZzq5r2I6QKZSOkzaEDp3ue46DDNdOdkN
rjodEKc6BWz3Od35lDoIsxs50IUtOjQDLDmA/+05+D+YOa+lUDmviVI5qGl/OXicBjlfZ3A5iWqI
OXSlxzmBQx85NTg1OTWacTjlLRY54ZlWOYdtJTmXt985f3k8OQDmJzl19+w5A1PvOSS8GDimlYw5
TlVmOX3iqzh5EpY5Zh7sOZcW8TkRbkw5P0GJOQsNLDj5suY5PdvHORRz2zjYNzw5Emw8OQmlBjkU
6LE4pCZxOR7LmjkGzH44+p+2OQFVyjkQgb84xZpnOSXP6TiqwAA5FFvsOKyqzjiF5qE40ThJOJ9F
Rji2SCc4tiKeOJj8yjki52Q4ybtfOKWo7DjezZ84N/JEONP6JDjJvwM4rTLaOMSMpjic7HY4oJuN
ONTEkzgqUE85Ix1VOZCPYji0hww5A/RQORIwAzevj3w4gxCgOJUrrzjAUU44sST9OL+EqjiYAjk4
h5ZwON/CmDi61ls4S7oYOKLRtDh6UyI4s45EOEBkIzfs3Pg4k+rmOOeuLDetRgw4ZXM4N8vlQDik
gjo4LUN6OAEWSjiCPTc4N4XlODSDvzhpQU04MTj1OE9yODg+A5g4OO2+OA0P2ziGLjI4Dzf6N8tX
jzhaEmc4VbGwOD8p3DfU3QQ4HSTNOJskKDhwSZA4symuOABT0zcijN44Wc6KOGvF7jgiY1Q4nRDs
OARFYTe84VA4T4H/OIavjThcRzo3h6MvN/TjbDeWm6Q4ChvwOGF43Dg4SWE4W9auOH8Y0DgC+hk3
9DpzOBCtQzc/90A4MsS4OT3zUTlytcA4GBQVNw+UqjfsuU43Kt4POEoLAjeG6Bs3MfPSN+q6ATeb
EUI4MbCEN4Ssgjfgamg3l+wfN9tFmje9lLI3soUGOBuZhDe8/F43sm2VOBC6bjeYAbc3rgFBN2pI
sjdkWYQ3ljhuOB14BjhVdzc3wQGeN+9UATeaqcc3jFEGN+wiUzgR6Og4MS6JN/BZmTfqxHI3Lcat
N7bDMzfg9tY3n4fwN7pUxjfJTg04WlU0N4vtqzgKbWQ3Ikr3N+6gLTff2/s4cyMpOQHTPzcN+Oo3
VEseNwW7vzagotE3hGA9N6SErDhQQRg3Ch/MN5RqWzgPAeQ3vbiaOA1RNDeRS8w3y8qMN1vm/jgA
UKY32ZsEN4ZCsjdIeUU3h+d3N7kbRDd3SQw3R7m8N1qh/De4ets3gxf3NvhU8DeM6jg3bZuPNyzG
LDfVq6M3lDhlNtCn8Dg3gO82s0k4N3MeSjdN0QQ348q7N+S2QjgWmEw3LxjsN3/TyDeGw103cn0O
N37FjjcZu/c21olINxFyQjdo43s4PWH3Nx6ovjbpsXY4G8pdNPqgXDfDLfc2+pB8N4rb/DdB/7U3
8PYJN406yTdL3z83ETGZNyPXTzcvez43W5ZWNw1tsjdbQDA3drhsNpFXszfM1EY3UANBN466azc/
5nw3R1fXN3DNvDeIy6o3oue4N0d5HDby4WI31+MlN2GVUjgfUGc3kZvmODI9dDg7M+Y3czYUNyZw
FjgDGRI4TetWNtJmPzfhDN03q/EGN0aufjeC6B83WZ7iN4DLiTdUtrM3gF2cN+g4tDfLVoM3nYj8
N/L7BTed6Xg3c0HbN0x12DfKvCw3hkSvNwVObjcYdQw24xjgN0zQ4zcdWZ03YaUYN0u4OjeCTvI3
gsrwN1CR7jdIWB83tnyPNx7z+zagaA83UVMFN4SyZDdc3yI3iYuTNyFI3TdfOk83eyBMN320Kjd8
vik3EJqUN5pyqTeicA83obkWN1OrAzdkMUo3X5m7N4olmzeTuZg3gl1hNzgO9Db/2Js3YYkqN2r/
4DcZDnM3hdZbN47Jojd+/m43hsYHN3ZQ7ze8kyg3CL+cN0JuYTb3uFU3FJDCNxw60jefAZM3fpxD
N4eYrjcB/E43d2K8NqpgHTbNATU3pNz9N8B5cDb6yjw3jX6zN7lwYzeNRn03g7PnN0P37zY1K0U3
qW26N3w6MzeKK9E3a+ZwNuROgzc7AHU="
  }
  @ ./p3d-1 video:gl:p3d {
    #%graph.x 376
    #%graph.y 110
    .code "

    @P(1)
    float\[\] fft;   
    
    @Override
    public void draw() \{
        colorMode(HSB);
        
        if (fft.length == 0) \{
            return;
        \}
        lights();
        int numCircles = 400;
        double t = sin(millis() / 1000.0 * 0.2);
        double c = 85;
        noStroke();
        translate(width/2, height/2);
        rotateX(sin(millis() * 0.0003));
        rotateY(sin(millis() * 0.0004));
        rotateZ(sin(millis() * 0.0005));
        scale(abs(sin(millis() * 0.0001)) + 0.8);
        for (int i = 0; i < numCircles; i++) \{
            fill( (i * abs(t) % 255), 255, 230);
            pushMatrix();
            rotate(radians((t + 37) * i));
            translate(sqrt(c*i), sqrt(c*i), dB(fft\[((i/10)%fft.length)\]));
            rect(-width/4,0,width/2,0.25);
            sphere(4);
            popMatrix();
        \}
    \}
    
    float dB(float x) \{
        if (x == 0) \{
            return 0;
        \} else \{
            return 10 * (float) Math.log10(x);
        \}
    \}
    
"
    .fft "rO0ABXVyAAJbRgucgYki4AxCAgAAeHAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA="
  }
  @ ./composite-1 video:composite {
    #%graph.x 574
    #%graph.y 110
    .mode Add
    .mix 0.5
  }
  ~ ./composite-1!out ./output-1!in
  ~ ./p3d-1!out ./composite-1!in
  ~ ./composite-1!out ./composite-1!src
}
